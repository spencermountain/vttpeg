!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).vttpeg=e()}(this,function(){"use strict";function t(t){const e=t.split(":"),n=parseInt(e[0],10),r=parseInt(e[1],10),s=e[2].split("."),i=parseInt(s[0],10),o=parseInt(s[1],10);return l=3600*n+60*r+i+o/1e3,Math.round(10*l)/10;var l}const e=(t,e)=>t.map(t=>(t.startTime+=e,t.endTime+=e,t));class n{constructor(e){this.entries=function(e){const n=e.trim().split("\n");if(!n[0].includes("WEBVTT"))throw new Error("Invalid WebVTT format");const r=[];let s=null,i=!1;for(let e=1;e<n.length;e++){const o=n[e].trim();if(!o)continue;const l=o.match(/(\d{2}:\d{2}:\d{2}\.\d{3})\s+-->\s+(\d{2}:\d{2}:\d{2}\.\d{3})/);l?(i&&s&&r.push(s),s={startTime:t(l[1]),endTime:t(l[2]),text:[]},i=!0):i&&s&&s.text.push(o)}return i&&s&&r.push(s),r}(e)}json(){return this.entries}text(){return this.entries.map(t=>t.text).join("\n")}out(){return this.entries.map(t=>t.text).join("\n")}debug(){console.log("--------------------------------"),console.log(this.entries),console.log(this.stats()),console.log("--------------------------------")}stats(){return(t=>{let e=t.reduce((t,e)=>t+e.text.split(" ").length,0),n=t.reduce((t,e)=>t+e.endTime-e.startTime,0);return{duration:n.toFixed(2),entries:t.length,wordCount:e,wordsPerMinute:(e/n*60).toFixed(2)}})(this.entries)}lint(t={}){return((t,e={})=>{e.silent=e.silent||!1;let n=[];for(let e=0;e<t.length;e+=1){let r=t[e];r.startTime>=r.endTime&&n.push(`StartTime is greater than EndTime for entry ${e}`),0===r.text.length&&n.push(`Text is empty for entry ${e}`),r.text.length>100&&n.push(`Text is too long for entry ${e}`)}return n.length>0?e.silent||(console.log("Lint errors: "),console.log(n)):e.silent||console.log("No lint errors found"),n})(this.entries,t)}isValid(t={}){return((t,e={})=>{e.silent=e.silent||!1;let n=[];t&&0!==t.length||n.push("No entries found");for(let e=0;e<t.length;e+=1){let r=t[e];r.startTime&&r.endTime||n.push(`Invalid start or end time for entry ${e}`),r.startTime>=r.endTime&&n.push(`Start time is greater than end time for entry ${e}`)}return!(n.length>0&&(e.silent||(console.log("Validation errors: "),console.log(n)),1))})(this.entries,t)}shift(t){return e(this.entries,t)}shiftLeft(t){return e(this.entries,-t)}shiftRight(t){return e(this.entries,t)}sort(){return this.entries.sort((t,e)=>t.startTime-e.startTime)}gaps(){return((t,e={})=>{const n=e.minGapSeconds||5,r=e.minSceneDuration||30;if(0===t.length)return[];const s=[];for(let e=0;e<t.length-1;e++){const i=t[e],o=t[e+1],l=o.startTime-i.endTime;if(l>=n){const t=i.endTime+l/2;(0===s.length||t-s[s.length-1]>=r)&&s.push({startTime:i.endTime,midpoint:t,endTime:o.startTime,duration:l})}}return s})(this.entries)}firstEntry(){return this.entries[0]}lastEntry(){return this.entries[this.entries.length-1]}duration(){return this.lastEntry().endTime-this.firstEntry().startTime}}return function(t=""){return new n(t)}});
